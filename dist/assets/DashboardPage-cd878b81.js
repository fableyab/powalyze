import{bF as c,a8 as S,r as o,D as A,k as e,N as _,B as m,T as P,t as R,K as D,a7 as p,ad as E,L as u}from"./index-b9d02c55.js";import{P as k}from"./plus-6ef6bc8a.js";import{A as U}from"./arrow-up-right-8defc601.js";const i={USERS:"powalyze_users",CLIENTS:"powalyze_clients",PROJECTS:"powalyze_projects",REPORTS:"powalyze_reports",AUDIT:"powalyze_audit"},l=s=>JSON.parse(localStorage.getItem(s)||"[]"),x=(s,t)=>localStorage.setItem(s,JSON.stringify(t)),I=()=>{if(l(i.PROJECTS).length===0){const s=[{id:"p1",client_id:"c1",name:"Digital Transformation Alpha",status:"active",budget:12e4,actual_cost:45e3,progress:35,risk_level:"low",start_date:"2024-01-01",end_date:"2024-12-31"},{id:"p2",client_id:"c1",name:"Cloud Migration",status:"risk",budget:85e3,actual_cost:6e4,progress:65,risk_level:"high",start_date:"2024-02-01",end_date:"2024-08-30"},{id:"p3",client_id:"c1",name:"ERP Upgrade",status:"planned",budget:25e4,actual_cost:0,progress:0,risk_level:"medium",start_date:"2024-06-01",end_date:"2025-06-01"}];x(i.PROJECTS,s)}};I();const h={getUser:async s=>l(i.USERS).find(r=>r.email===s),createUser:async s=>{const t=l(i.USERS),r={...s,id:crypto.randomUUID(),created_at:new Date().toISOString()};return t.push(r),x(i.USERS,t),r},getClientByUserId:async s=>({id:"c1",user_id:s,company_name:"Demo Company",subscription_plan:"premium"}),getProjects:async s=>l(i.PROJECTS),createProject:async s=>{const t=l(i.PROJECTS),r={...s,id:crypto.randomUUID(),created_at:new Date().toISOString()};return t.push(r),x(i.PROJECTS,t),r},getReports:async s=>[{id:"r1",title:"Executive Overview",type:"pmo",last_viewed_at:new Date().toISOString()},{id:"r2",title:"Financial Forecast",type:"finance",last_viewed_at:new Date(Date.now()-864e5).toISOString()},{id:"r3",title:"Sales Performance",type:"sales",last_viewed_at:null}],logAction:async(s,t,r)=>{const d=l(i.AUDIT);d.push({id:crypto.randomUUID(),user_id:s,action:t,resource:r,created_at:new Date().toISOString()}),x(i.AUDIT,d)}},T={getProjects:async s=>{if(c){const{data:t,error:r}=await c.from("projects").select("*").eq("client_id",s).order("created_at",{ascending:!1});if(r)throw r;return t}return h.getProjects(s)},createProject:async s=>{if(c){const{data:t,error:r}=await c.from("projects").insert([s]).select().single();if(r)throw r;return t}return h.createProject(s)}},O={getReports:async s=>{if(c){const{data:t,error:r}=await c.from("reports").select("*").eq("client_id",s);if(r)throw r;return t}return h.getReports(s)}},z=()=>{const{user:s,clientData:t,loading:r}=S(),[d,b]=o.useState([]),[g,j]=o.useState([]),[v,w]=o.useState(!0),{toast:N}=A();return o.useEffect(()=>{(async()=>{if(s)try{const n=(t==null?void 0:t.id)||"c1",[f,y]=await Promise.all([T.getProjects(n),O.getReports(n)]);b(f),j(y)}catch(n){console.error("Dashboard data error",n),N({variant:"destructive",title:"Error",description:"Failed to load dashboard data."})}finally{w(!1)}})()},[s,t]),r||v?e.jsx("div",{className:"min-h-screen bg-[#0A0A0A] flex items-center justify-center",children:e.jsx("div",{className:"text-[#BFA76A] animate-pulse",children:"Loading Dashboard..."})}):e.jsxs("div",{className:"min-h-screen bg-[#0A0A0A] text-white",children:[e.jsx(_,{}),e.jsxs("main",{className:"container mx-auto px-6 pt-32 pb-12",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-12",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-display font-bold text-white mb-2",children:["Welcome back, ",e.jsx("span",{className:"text-[#BFA76A]",children:s==null?void 0:s.name})]}),e.jsx("p",{className:"text-gray-400",children:"Here's what's happening with your projects today."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(m,{variant:"outline",className:"border-white/10 text-white hover:bg-white/5",children:[e.jsx(P,{size:16,className:"mr-2"})," Settings"]}),e.jsxs(m,{className:"bg-[#BFA76A] text-black hover:bg-white font-bold",children:[e.jsx(k,{size:16,className:"mr-2"})," New Project"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12",children:[e.jsxs("div",{className:"bg-[#111] p-6 rounded-xl border border-white/10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 text-blue-500 rounded-lg",children:e.jsx(R,{size:20})}),e.jsxs("span",{className:"text-xs text-green-500 flex items-center gap-1",children:["+2 ",e.jsx(U,{size:12})]})]}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:d.length}),e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Active Projects"})]}),e.jsxs("div",{className:"bg-[#111] p-6 rounded-xl border border-white/10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-2 bg-yellow-500/10 text-yellow-500 rounded-lg",children:e.jsx(D,{size:20})}),e.jsx("span",{className:"text-xs text-gray-500",children:"On Time"})]}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:"94%"}),e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Schedule Adherence"})]}),e.jsxs("div",{className:"bg-[#111] p-6 rounded-xl border border-white/10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-500/10 text-purple-500 rounded-lg",children:e.jsx(p,{size:20})}),e.jsx("span",{className:"text-xs text-green-500 flex items-center gap-1",children:"New"})]}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:g.length}),e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Available Reports"})]}),e.jsxs("div",{className:"bg-[#111] p-6 rounded-xl border border-white/10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-2 bg-red-500/10 text-red-500 rounded-lg",children:e.jsx(E,{size:20})}),e.jsx("span",{className:"text-xs text-red-500",children:"Action Req."})]}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:"1"}),e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wider",children:"Critical Risks"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-[#111] rounded-xl border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-white/10 flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-white",children:"Recent Projects"}),e.jsx(m,{variant:"ghost",size:"sm",className:"text-xs text-[#BFA76A]",children:"View All"})]}),e.jsx("div",{className:"p-6",children:d.length>0?e.jsx("div",{className:"space-y-4",children:d.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/5 rounded-lg hover:bg-white/10 transition-colors cursor-pointer group",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${a.status==="active"?"bg-green-500":a.status==="risk"?"bg-red-500":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white group-hover:text-[#BFA76A] transition-colors",children:a.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Budget: CHF ",a.budget.toLocaleString()," â€¢ Risk: ",a.risk_level]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-bold text-white",children:[a.progress,"%"]}),e.jsx("div",{className:"w-24 h-1 bg-gray-700 rounded mt-1",children:e.jsx("div",{className:"h-full bg-[#BFA76A] rounded",style:{width:`${a.progress}%`}})})]})]},a.id))}):e.jsx("div",{className:"text-center py-10 text-gray-500",children:"No projects found."})})]}),e.jsxs("div",{className:"bg-[#111] rounded-xl border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-white/10",children:e.jsx("h3",{className:"font-bold text-white",children:"Your Reports"})}),e.jsxs("div",{className:"p-4 space-y-2",children:[g.map(a=>e.jsx(u,{to:"/demo-report",children:e.jsx("div",{className:"p-4 rounded-lg hover:bg-white/5 transition-colors group cursor-pointer border border-transparent hover:border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-[#0A0A0A] rounded border border-white/10 group-hover:border-[#BFA76A]/50 transition-colors",children:e.jsx(p,{size:18,className:"text-[#BFA76A]"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white text-sm group-hover:text-[#BFA76A] transition-colors",children:a.title}),e.jsx("div",{className:"text-xs text-gray-500 uppercase mt-1",children:a.type})]})]})})},a.id)),e.jsx("div",{className:"pt-4 mt-4 border-t border-white/10",children:e.jsx(u,{to:"/powerbi-embed",children:e.jsxs("div",{className:"p-4 rounded-lg bg-gradient-to-r from-blue-900/20 to-transparent border border-blue-500/20 hover:border-blue-500/50 transition-colors",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-400 mb-1",children:"New: Embedded Analytics"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Try our new secure Power BI embedding feature."})]})})})]})]})]})]})]})};export{z as default};
