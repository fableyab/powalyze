import{D as S,r as u,k as e,B as C,E as k,ae as P,af as D,ag as B,ah as F,ai as O,L as E}from"./index-7b89e187.js";import{u as L}from"./ClientContext-770d4aba.js";import{I as m}from"./input-8cdbed1f.js";import{C as M}from"./card-e44021e9.js";import{S as T}from"./StatusBadge-a03c2ab7.js";import{P as z}from"./ProgressBar-52ca8e64.js";import{T as A}from"./textarea-786614c4.js";import{S as v,a as N,b as w,c as y,d as i}from"./select-3fa1bfee.js";import{S as H}from"./save-2229a66e.js";import{P as $}from"./plus-742d82ec.js";import{S as R}from"./search-2ad02d4c.js";import{C as V}from"./calendar-69a40799.js";import"./index-d203b311.js";import"./chevron-down-129b5489.js";const I=({initialData:r,onSubmit:x,onCancel:n})=>{const{toast:b}=S(),[o,c]=u.useState(!1),[a,g]=u.useState({name:"",description:"",type:"Operational",status:"Planning",priority:"Medium",sponsor:"",manager:"",team:"",budget:"",startDate:"",endDate:"",risks:"",resources:""}),[l,f]=u.useState({});u.useEffect(()=>{r&&g({...r,team:Array.isArray(r.team)?r.team.join(", "):r.team||"",resources:Array.isArray(r.resources)?r.resources.join(", "):r.resources||""})},[r]);const s=(t,j)=>{g(h=>({...h,[t]:j})),l[t]&&f(h=>({...h,[t]:null}))},d=()=>{const t={};return(!a.name||a.name.length<3)&&(t.name="Name must be at least 3 characters"),(!a.budget||isNaN(a.budget))&&(t.budget="Valid budget is required"),a.startDate||(t.startDate="Start date is required"),f(t),Object.keys(t).length===0},p=async t=>{if(t.preventDefault(),!d()){b({variant:"destructive",title:"Validation Error",description:"Please fix the errors in the form."});return}c(!0);try{const j={...a,team:a.team.split(",").map(h=>h.trim()).filter(Boolean),resources:a.resources.split(",").map(h=>h.trim()).filter(Boolean),budget:Number(a.budget)};await x(j)}catch(j){console.error(j)}finally{c(!1)}};return e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"Project Name *"}),e.jsx(m,{value:a.name,onChange:t=>s("name",t.target.value),className:`bg-black border-white/10 ${l.name?"border-red-500":""}`,placeholder:"e.g. ERP Migration"}),l.name&&e.jsx("span",{className:"text-xs text-red-500",children:l.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"Type"}),e.jsxs(v,{value:a.type,onValueChange:t=>s("type",t),children:[e.jsx(N,{className:"bg-black border-white/10 text-white",children:e.jsx(w,{})}),e.jsxs(y,{className:"bg-[#1A1A1A] border-white/10 text-white",children:[e.jsx(i,{value:"Strategic",children:"Strategic"}),e.jsx(i,{value:"Operational",children:"Operational"}),e.jsx(i,{value:"Tactical",children:"Tactical"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"Status"}),e.jsxs(v,{value:a.status,onValueChange:t=>s("status",t),children:[e.jsx(N,{className:"bg-black border-white/10 text-white",children:e.jsx(w,{})}),e.jsxs(y,{className:"bg-[#1A1A1A] border-white/10 text-white",children:[e.jsx(i,{value:"Planning",children:"Planning"}),e.jsx(i,{value:"Active",children:"Active"}),e.jsx(i,{value:"On Hold",children:"On Hold"}),e.jsx(i,{value:"Completed",children:"Completed"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"Priority"}),e.jsxs(v,{value:a.priority,onValueChange:t=>s("priority",t),children:[e.jsx(N,{className:"bg-black border-white/10 text-white",children:e.jsx(w,{})}),e.jsxs(y,{className:"bg-[#1A1A1A] border-white/10 text-white",children:[e.jsx(i,{value:"Low",children:"Low"}),e.jsx(i,{value:"Medium",children:"Medium"}),e.jsx(i,{value:"High",children:"High"}),e.jsx(i,{value:"Critical",children:"Critical"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"Budget (CHF) *"}),e.jsx(m,{type:"number",value:a.budget,onChange:t=>s("budget",t.target.value),className:`bg-black border-white/10 ${l.budget?"border-red-500":""}`,placeholder:"50000"}),l.budget&&e.jsx("span",{className:"text-xs text-red-500",children:l.budget})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"Manager"}),e.jsx(m,{value:a.manager,onChange:t=>s("manager",t.target.value),className:"bg-black border-white/10",placeholder:"Project Manager Name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"Start Date *"}),e.jsx(m,{type:"date",value:a.startDate,onChange:t=>s("startDate",t.target.value),className:`bg-black border-white/10 ${l.startDate?"border-red-500":""}`}),l.startDate&&e.jsx("span",{className:"text-xs text-red-500",children:l.startDate})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"End Date"}),e.jsx(m,{type:"date",value:a.endDate,onChange:t=>s("endDate",t.target.value),className:"bg-black border-white/10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"Description"}),e.jsx(A,{value:a.description,onChange:t=>s("description",t.target.value),className:"bg-black border-white/10 min-h-[100px]",placeholder:"Detailed project description..."}),e.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[a.description.length," chars"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"Team Members"}),e.jsx(m,{value:a.team,onChange:t=>s("team",t.target.value),className:"bg-black border-white/10",placeholder:"Comma separated names"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"Resources"}),e.jsx(m,{value:a.resources,onChange:t=>s("resources",t.target.value),className:"bg-black border-white/10",placeholder:"Comma separated resources (e.g. Servers, Licenses)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"Risks"}),e.jsx(A,{value:a.risks,onChange:t=>s("risks",t.target.value),className:"bg-black border-white/10",placeholder:"Identify potential risks..."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-white/10",children:[e.jsx(C,{type:"button",variant:"ghost",onClick:n,disabled:o,className:"text-gray-400 hover:text-white",children:"Cancel"}),e.jsxs(C,{type:"submit",disabled:o,className:"bg-[#BFA76A] text-black hover:bg-white font-bold min-w-[140px]",children:[o?e.jsx(k,{className:"animate-spin mr-2",size:16}):e.jsx(H,{className:"mr-2",size:16}),r?"Update Project":"Create Project"]})]})]})},q=({isOpen:r,onClose:x,initialData:n,onSubmit:b})=>{const o=c=>{c||x()};return e.jsx(P,{open:r,onOpenChange:o,children:e.jsxs(D,{className:"bg-[#111] border-white/10 text-white max-w-xl shadow-2xl overflow-y-auto max-h-[90vh]",children:[e.jsxs(B,{children:[e.jsx(F,{className:"text-2xl font-display font-bold",children:n?"Edit Project":"Create New Project"}),e.jsx(O,{className:"text-gray-400",children:n?`Update details for ${n.name}.`:"Fill in the information below to initialize a new portfolio item."})]}),e.jsx("div",{className:"mt-4",children:e.jsx(I,{initialData:n,onSubmit:async c=>{await b(c),x()},onCancel:x})})]})})},re=()=>{const{projects:r,addProject:x}=L(),{toast:n}=S(),[b,o]=u.useState(!1),[c,a]=u.useState(""),[g,l]=u.useState("All"),f=r.filter(s=>{const d=s.name.toLowerCase().includes(c.toLowerCase()),p=g==="All"||s.status===g;return d&&p});return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-white mb-2",children:"Mes Projets"}),e.jsx("p",{className:"text-gray-400",children:"Gérez et suivez l'avancement de vos initiatives."})]}),e.jsxs(C,{onClick:()=>o(!0),className:"bg-[#BFA76A] text-black hover:bg-white font-bold flex items-center gap-2",children:[e.jsx($,{size:16})," Nouveau Projet"]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 bg-[#111] p-4 rounded-xl border border-white/10",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(R,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",size:18}),e.jsx(m,{placeholder:"Rechercher un projet...",className:"pl-10 bg-[#0A0A0A] border-white/10 text-white focus:border-[#BFA76A]",value:c,onChange:s=>a(s.target.value)})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 md:pb-0",children:["All","Active","Completed","On Hold","At Risk"].map(s=>e.jsx("button",{onClick:()=>l(s),className:`px-4 py-2 rounded-lg text-sm font-bold whitespace-nowrap transition-colors ${g===s?"bg-[#BFA76A] text-black":"bg-[#1A1A1A] text-gray-400 hover:text-white"}`,children:s==="All"?"Tous":s},s))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(s=>e.jsx(E,{to:`/espace-client/projets/${s.id}`,children:e.jsxs(M,{className:"bg-[#111] border-white/10 p-6 hover:border-[#BFA76A] transition-all duration-300 h-full flex flex-col group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx(T,{status:s.status}),e.jsx("span",{className:"text-xs text-gray-500 font-mono",children:s.type})]}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2 group-hover:text-[#BFA76A] transition-colors",children:s.name}),e.jsx("p",{className:"text-sm text-gray-400 mb-6 line-clamp-2 flex-grow",children:s.description}),e.jsxs("div",{className:"space-y-4 mt-auto",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500 gap-2",children:[e.jsx(V,{size:14}),e.jsxs("span",{children:["Deadline: ",new Date(s.deadline).toLocaleDateString()]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-300",children:[e.jsx("span",{children:"Avancement"}),e.jsxs("span",{className:"font-bold",children:[s.progress,"%"]})]}),e.jsx(z,{progress:s.progress})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-white/5",children:[e.jsxs("div",{className:"flex -space-x-2",children:[s.team.slice(0,3).map((d,p)=>e.jsx("div",{className:"w-8 h-8 rounded-full bg-[#222] border-2 border-[#111] flex items-center justify-center text-[10px] font-bold text-gray-300",title:d.name,children:d.avatar},p)),s.team.length>3&&e.jsxs("div",{className:"w-8 h-8 rounded-full bg-[#333] border-2 border-[#111] flex items-center justify-center text-[10px] font-bold text-gray-300",children:["+",s.team.length-3]})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.documentsCount," docs"]})]})]})]})},s.id))}),e.jsx(q,{isOpen:b,onClose:()=>o(!1),onSubmit:async s=>{const d=await x(s);n({title:"Projet créé",description:`${d.name} est ajouté à votre portefeuille.`})}})]})};export{re as default};
